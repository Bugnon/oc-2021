<!doctype html>
<html class="no-js" lang="fr">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Recherche" href="../search.html" /><link rel="next" title="8. Othello" href="../projet8/projet.html" /><link rel="prev" title="6. Démineur" href="../projet6/projet.html" />

    <link rel="shortcut icon" href="../_static/modulo-icon.ico"/><meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>7. Puissance 4 - projet final</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="../_static/codeplay.css" />
    <link rel="stylesheet" type="text/css" href="../_static/questions.css" />
    <link rel="stylesheet" type="text/css" href="../_static/videos.css" />
    <link rel="stylesheet" type="text/css" href="../_static/logic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/blanks.css" />
    <link rel="stylesheet" type="text/css" href="../_static/timeline.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/global.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/reactions.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/progress.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-foreground-primary: black;
  --color-foreground-secondary: #5a5c63;
  --color-foreground-muted: #646776;
  --color-foreground-border: #878787;
  --color-background-primary: white;
  --color-background-secondary: #f8f9fb;
  --color-background-hover: #efeff4ff;
  --color-background-over--transparent: #efeff400;
  --color-background-border: #eeebee;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-brand-primary: #8044FF;
  --color-brand-content: #8044FF;
  --admonition-font-size: 0.9rem;
  --admonition-title-font-size: 0.9rem;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-foreground-primary: #ffffffcc;
  --color-foreground-secondary: #9ca0a5;
  --color-foreground-muted: #81868d;
  --color-foreground-border: #666666;
  --color-background-primary: #131416;
  --color-background-secondary: #131416;
  --color-background-hover: #1e2124ff;
  --color-background-over--transparent: #1e212400;
  --color-background-border: #303335;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-brand-primary: #06CCC0;
  --color-brand-content: #06CCC0;
  --admonition-font-size: 0.9rem;
  --admonition-title-font-size: 0.9rem;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-foreground-primary: #ffffffcc;
  --color-foreground-secondary: #9ca0a5;
  --color-foreground-muted: #81868d;
  --color-foreground-border: #666666;
  --color-background-primary: #131416;
  --color-background-secondary: #131416;
  --color-background-hover: #1e2124ff;
  --color-background-over--transparent: #1e212400;
  --color-background-border: #303335;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-brand-primary: #06CCC0;
  --color-brand-content: #06CCC0;
  --admonition-font-size: 0.9rem;
  --admonition-title-font-size: 0.9rem;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">projet final</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/modulo-logo-light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/modulo-logo-dark.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">projet final</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Recherche name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../projet1/projet.html">1. Jeu 2048</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projet2/projet.html">2. Survie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projet3/projet.html">3. Pacman</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projet4/projet.html">4. TRON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projet5/projet.html">5. Projet - Snake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projet6/projet.html">6. Démineur</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">7. Puissance 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projet8/projet.html">8. Othello</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annex.html">9. Annexe</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="puissance-4">
<h1><span class="section-number">7. </span>Puissance 4<a class="headerlink" href="#puissance-4" title="Lien permanent vers ce titre">¶</a></h1>
<p>Emilien</p>
<section id="but-du-jeu">
<h2>But du jeu<a class="headerlink" href="#but-du-jeu" title="Lien permanent vers ce titre">¶</a></h2>
<p>Aligner 4 jetons de la même couleur horizontalement, verticalement ou en diagonale.</p>
</section>
<section id="description-du-jeu">
<h2>Description du jeu<a class="headerlink" href="#description-du-jeu" title="Lien permanent vers ce titre">¶</a></h2>
<p>On joue sur un plateau 6x7, les premiers jetons se déposent sur la ligne du bas, puis les jetons suivants viennent se poser “par-dessus“ (comme si on jouait avec de la gravité)</p>
</section>
<section id="comment-jouer">
<h2>Comment jouer<a class="headerlink" href="#comment-jouer" title="Lien permanent vers ce titre">¶</a></h2>
<p>On peut utiliser la souris ou le clavier (touches 1 à 7)pour choisir dans quelle colonne est-ce que l’on désire placer son jeton.</p>
</section>
<section id="options-supplementaires">
<h2>Options supplémentaires<a class="headerlink" href="#options-supplementaires" title="Lien permanent vers ce titre">¶</a></h2>
<p>Il est possible d’annuler les coups joués, de créer une nouvelle partie et de réinitialiser les scores.</p>
</section>
<section id="representation-de-letat">
<h2>Réprésentation de l’état<a class="headerlink" href="#representation-de-letat" title="Lien permanent vers ce titre">¶</a></h2>
<p>L’état du jeu est représenté avec un tableau 2D appelé <code class="docutils literal notranslate"><span class="pre">state</span></code></p>
<div class="interactive_code"><iframe border="0" cellspacing="0" class="codeframe" data-code="c3RhdGUgPSBbXQoKZm9yIGkgaW4gcmFuZ2UoNik6CiAgICBzdGF0ZS5hcHBlbmQoWzBdICo3KQoKZm9yIGxpbmUgaW4gc3RhdGU6CiAgICBwcmludChsaW5lKQ==" data-file="Y29kZS5weQ==" frameborder="0" scrolling="no" src="../codeplay/frame.html"></iframe></div></section>
<section id="codeplay">
<h2>Codeplay<a class="headerlink" href="#codeplay" title="Lien permanent vers ce titre">¶</a></h2>
<p>Voici le jeu final !
(Cliquer sur la flèche bleue pour lancer le jeu, puis retrouver la fenêtre du jeu au bas de la page)</p>
<div class="interactive_code"><iframe border="0" cellspacing="0" class="codeframe" data-code="IiIiCkdhbWUncyBuYW1lIDoKICAgIENvbm5lY3QgNAogICAgKOKAnFB1aXNzYW5jZSA04oCcIGluIGZyZW5jaCkKClJ1bGVzIDoKICAgIFRoaXMgaXMgYSBnYW1lIGZvciB0d28gcGxheWVycywgcGxheWluZyBpbiBhIDZ4NyBib2FyZC4KCiAgICBXaGVuIGEgcGllY2UgaXMgcGxhY2VkIGluIGEgY29sdW1uLCBpdCBpcyBwbGFjZWQgaW4gdGhlIGxvd2VzdAogICAgZnJlZSBjZWxsIG9mIHRoZSBjb2x1bW4gKGFzIGlmIHBsYXlpbmcgd2l0aCBncmF2aXR5KS4KCiAgICBUaGUgZ29hbCBvZiB0aGUgZ2FtZSBpcyB0byBhbGlnbiA0IHRva2VucyBvZiB0aGUgc2FtZSBjb2xvdXIgaG9yaXpvbnRhbGx5LAogICAgdmVydGljYWxseSBvciBkaWFnb25hbGx5LgoKTXkgY29kZSA6CiAgICBJbiBteSB2ZXJzaW9uLCB0aGUgc2NvcmUgb2YgdGhlIHBsYXllcnMgcmVwcmVzZW50cyB0aGUgbnVtYmVyIG9mIGdhbWVzIHdvbiwgCiAgICBhbmQgdGhleSBjYW4gY2FuY2VsIHRoZWlyIG1vdmUsIGNyZWF0ZSBhIG5ldyBnYW1lIG9yIHJlc2V0IHRoZSBzY29yZXMgYXQgYW55IHRpbWUuCgogICAgV2hlbiB5b3UgcnVuIHRoZSBjb2RlLCB5b3Ugd2lsbCBmaXJzdCBzZWUgc29tZSBnYW1lcGxheSBpbmZvcm1hdGlvbnMgaW4gdGhlCiAgICBjb25zb2xlLCBhbmQgd2lsbCBoYXZlIHRvIGVudGVyIHRoZSBuYW1lcyBvZiB0aGUgMiBwbGF5ZXJzLgogICAgWW91IHdpbGwgdGhlbiBjYW4gcGxheSBvbiB0aGUgd2luZG93IHVzaW5nIHRoZSBtb3VzZSBvciBrZXlib2FyZC4KCiAgICBIYXZlIGZ1biAhCgpJbmZvcm1hdGlvbiBhYm91dCB0aGUgY29kZSA6CiAgICBjbGFzc2VzIDogNgogICAgbGluZXMgOiA5MTAKCgpOb3RlOiBpZiB0aGVyZSBhcmUgYW55IHByb2JsZW1zIHdoZW4gZG93bmxvYWRpbmcgdGhlIGF1ZGlvcywKICAgICAgaXQgc2hvdWxkIGJlIGEgcHJvYmxlbSBvZiB0aGUgcGF0aCB0byBmaW5kIHRoZSByaWdodCBhdWRpby4KICAgICAgdGhlIGxpbmVzIG9mIGNvZGUgY29uY2VybmVkIGFyZSAyODktMjkxLCA3NzgtNzgwIGFuZCA3ODgtMTkwLgogICAgICBJbiB0aGlzIHdlYnNpdGUgdGhlcmUgaXMgbm8gc291bmQsIHRoZSBsaW5lcyBjb25jZXJuZWQgYXJlIGlnbm9yZWQKCgpFbWlsaWVuIEJhcmRlCjE1LjA2LjIwMjIKIiIiCgoKZnJvbSBlbWFpbC5taW1lIGltcG9ydCBhdWRpbwpmcm9tIGh0dHAuY2xpZW50IGltcG9ydCBTV0lUQ0hJTkdfUFJPVE9DT0xTCmZyb20gdGV4dHdyYXAgaW1wb3J0IGZpbGwKZnJvbSB0a2ludGVyIGltcG9ydCBmaWxlZGlhbG9nCgpmcm9tIHR1cnRsZSBpbXBvcnQgKgppbXBvcnQgb3MKZnJvbSBweWdhbWUgaW1wb3J0IGluaXQKZnJvbSB0aW1lIGltcG9ydCBzbGVlcApmcm9tIHB5Z2FtZS5taXhlciBpbXBvcnQgbXVzaWMKCgpjbGFzcyBSZWN0YW5nbGU6CiAgICAiIiJEcmF3IGEgZmlsbGVkIHJlY3RhbmdsZS4iIiIKICAgIAogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBvcywgc2l6ZSwgY29sb3I9J2dyYXknLCBvdXRsaW5lPVRydWUpOgogICAgICAgICIiIkluaXRpYWxpemUgdGhlIHJlY3RhbmdsZSBhbmQgZHJhdyBpdC4iIiIKICAgICAgICAKICAgICAgICBzZWxmLnBvcyA9IHBvcwogICAgICAgIHNlbGYuc2l6ZSA9IHNpemUKICAgICAgICBzZWxmLmNvbG9yID0gY29sb3IKICAgICAgICBzZWxmLm91dGxpbmUgPSBvdXRsaW5lCiAgICAgICAgc2VsZi5kcmF3KCkKICAgIAoKICAgIGRlZiB0cmFjZShzZWxmKToKICAgICAgICAiIiJSdW5zIGFsb25nIHRoZSBlZGdlcyBvZiB0aGUgcmVjdGFuZ2xlLiIiIgoKICAgICAgICBmb3IgeCBpbiBzZWxmLnNpemUgKiAyOgogICAgICAgICAgICBmb3J3YXJkKHgpCiAgICAgICAgICAgIGxlZnQoOTApCiAgICAgICAgCgogICAgZGVmIGRyYXcoc2VsZik6CiAgICAgICAgIiIiRHJhdyB0aGUgb3V0bGluZSBvZiB0aGUgcmVjdGFuZ2xlIGFuZCBmaWxsIGl0IGEgY29sb3IgaXMgZGVmaW5lZC4iIiIKICAgICAgICAKICAgICAgICBnb3RvKHNlbGYucG9zKQogICAgICAgIAogICAgICAgIGlmIHNlbGYuY29sb3I6CiAgICAgICAgICAgIGZpbGxjb2xvcihzZWxmLmNvbG9yKQogICAgICAgICAgICBiZWdpbl9maWxsKCkKICAgICAgICAgICAgc2VsZi50cmFjZSgpCiAgICAgICAgICAgIGVuZF9maWxsKCkKICAgICAgICAKICAgICAgICBpZiBzZWxmLm91dGxpbmU6CiAgICAgICAgICAgIHBlbnNpemUoNSkKICAgICAgICAgICAgcGVuY29sb3IoJ2JsYWNrJykKICAgICAgICAgICAgZG93bigpCiAgICAgICAgICAgIHNlbGYudHJhY2UoKQogICAgICAgICAgICB1cCgpCgogICAgIAogICAgZGVmIGluc2lkZShzZWxmLCBwKToKICAgICAgICAiIiJDaGVjayBpZiB0aGUgcG9pbnQgcCBpcyBpbnNpZGUgdGhlIHJlY3RhbmdsZS4iIiIKICAgICAgICAKICAgICAgICB4LCB5ID0gc2VsZi5wb3MKICAgICAgICB3LCBoID0gc2VsZi5zaXplCiAgICAgICAgCiAgICAgICAgcmV0dXJuIDAgPCBwWzBdLXggPCB3IGFuZCAwIDwgcFsxXS15IDwgaAogICAgICAgIAoKY2xhc3MgVGV4dDoKICAgICIiIkRyYXcgYSB0ZXh0IGF0IGEgZ2l2ZW4gcG9zaXRpb24uIiIiCiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwb3MsIHRleHQsIHNpemU9MTYsIGFsaWduPSdjZW50ZXInLCBjb2w9J2JsYWNrJyk6CiAgICAgICAgIiIiSW5pdGlsaXplcyB0aGUgdGV4dC4iIiIKICAgICAgICAKICAgICAgICBzZWxmLnBvcyA9IHBvcwogICAgICAgIHNlbGYudGV4dCA9IHRleHQKICAgICAgICBzZWxmLnNpemUgPSBzaXplCiAgICAgICAgc2VsZi5hbGlnbiA9IGFsaWduCiAgICAgICAgc2VsZi5jb2wgPSBjb2wKICAgICAgICBzZWxmLmRyYXcoKQoKCiAgICBkZWYgZHJhdyhzZWxmKToKICAgICAgICAiIiJEcmF3IHRoZSB0ZXh0LiIiIgogICAgICAgIAogICAgICAgIGdvdG8oc2VsZi5wb3MpCiAgICAgICAgY29sb3Ioc2VsZi5jb2wpCiAgICAgICAgd3JpdGUoc2VsZi50ZXh0LCBmb250PSgnVGltZXMnLCBzZWxmLnNpemUpLCBhbGlnbj1zZWxmLmFsaWduKQoKCmNsYXNzIEJ1dHRvbjoKICAgICIiIkNyZWF0ZSBhIGJ1dHRvbiB0aGF0IHRoZSBwbGF5ZXIgY2FuIGludGVyYWN0IHdpdGguIiIiCiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwb3MsIHRleHQsIHNpemU9KDgwLCAzMCksIGNvbG9yPSdtZWRpdW1zbGF0ZWJsdWUnLCBkaXNwbGF5ZWQ9VHJ1ZSk6CiAgICAgICAgIiIiQ3JlYXRlIGEgbmV3IEJ1dHRvbiBpbnN0YW5jZS4iIiIKICAgICAgICAKICAgICAgICBzZWxmLnJlY3QgPSBSZWN0YW5nbGUocG9zLCBzaXplLCBjb2xvcikKICAgICAgICB4LCB5ID0gcG9zCiAgICAgICAgdywgaCA9IHNpemUKICAgICAgICBzZWxmLmxhYmVsID0gVGV4dCgoeCArIHcvLzIsIHkgKyBoLy80KSwgdGV4dCwgaC8vMikKICAgICAgICBzZWxmLmRpc3BsYXllZCA9IGRpc3BsYXllZAogICAgCgogICAgZGVmIGluc2lkZShzZWxmLCBwKToKICAgICAgICAiIiJDaGVjayBpZiBwID0gKHgsIHkpIGlzIGluc2lkZSB0aGUgYnV0dG9uLiIiIgogICAgICAgIAogICAgICAgIHJldHVybiBzZWxmLnJlY3QuaW5zaWRlKHApCiAgICAKCiAgICBkZWYgZHJhdyhzZWxmKToKICAgICAgICAiIiJEcmF3IHRoZSBidXR0b24uIiIiCiAgICAgICAgCiAgICAgICAgc2VsZi5yZWN0LmRyYXcoKQogICAgICAgIHNlbGYubGFiZWwuZHJhdygpCgoKY2xhc3MgR3JpZDoKICAgICIiIkRlZmluZSBhIGdyaWQgY2xhc3Mgd2l0aCB0aGUgc2l6ZSAobiB4IG0pLgoKICAgIG4gaXMgdGhlIG51bWJlciBvZiBsaWduZXMsCiAgICBtIHRoZSBudW1iZXIgb2YgY29sdW1ucy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuPTYsIG09NywgZD00NSk6CiAgICAgICAgIiIiQ3JlYXRlIGEgbmV3IEdyaWQgaW5zdGFuY2UuIiIiCiAgICAgICAgCiAgICAgICAgc2VsZi5uID0gbiAgICAgICAgIyB2ZXJ0aWNhbCAoeSkKICAgICAgICBzZWxmLm0gPSBtICAgICAgICAjIGhvcml6b250YWwgKHgpCiAgICAgICAgc2VsZi5kID0gZCAgICAgICAgIyBkaXN0YW5jZQogICAgICAgIHNlbGYueDAgPSBtICogZCAvLyAyCiAgICAgICAgc2VsZi55MCA9IG4gKiBkIC8vIDIKCiAgICAgICAgIiIiVGhlIGdyaWQncyBzdGF0ZSBpcyBhIHR3by1kaW1lbnNpb25hbCBhcnJheS4KICAgICAgICBCeSBjb252ZW50aW9uIDoKICAgICAgICAgICAgcGxheWVyIG9uZSdzIHRva2VuID0gMSA7IHBsYXllciB0d28ncyB0b2tlbiA9IDIKICAgICAgICAgICAgZnJlZSBjZWxsID0gMCA7IHdpbm5pbmcgY2VsbCA9IDMgOyBkcmF3ID0gNAogICAgICAgICIiIgogICAgICAgIAogICAgICAgIHNlbGYuc3RhdGUgPSBbXQogICAgICAgIGZvciBpIGluIHJhbmdlKDYpOgogICAgICAgICAgICBzZWxmLnN0YXRlLmFwcGVuZChbMF0gKiA3KQogICAgICAgIAogICAgICAgIHNlbGYuZHJhdygpCgogICAgCiAgICBkZWYgaW5zaWRlKHNlbGYsIHgsIHkpOgogICAgICAgICIiIkNoZWNrIGlmICh4LCB5KSBpcyBpbnNpZGUgdGhlIGdyaWQuIiIiCiAgICAgICAgCiAgICAgICAgeDAgPSBzZWxmLngwCiAgICAgICAgeTAgPSBzZWxmLnkwCgogICAgICAgIHgwICs9IHNlbGYuZCAvLyAyCiAgICAgICAgeTAgKz0gc2VsZi5kIC8vIDIgICAgCiAgICAgICAgCiAgICAgICAgcmV0dXJuIC14MCA8IHggPCB4MCAtIHNlbGYuZCAvLyAyIGFuZCAteTAgPCB5IDwgeTAgLSBzZWxmLmQgLy8gMgogICAgCgogICAgZGVmIGdldF9jb2x1bW4oc2VsZiwgeCk6CiAgICAgICAgIiIiUmV0dXJucyB0aGUgY29vcmRpbmF0ZXMgKGJldHdlZW4gMCBhbmQgNikKICAgICAgICBvZiB0aGUgY29sdW1uIGluIHdoaWNoIHRoZSBwbGF5ZXIgaGFzIHBsYXllZC4KICAgICAgICAiIiIKICAgICAgICAKICAgICAgICB4ID0gKHggKyBzZWxmLmQgLy8gMikgLy8gc2VsZi5kICogc2VsZi5kCgogICAgICAgIGkgPSBpbnQoeCAvLyBzZWxmLmQpICsgc2VsZi5tIC8vIDIKCiAgICAgICAgcmV0dXJuIGkKCiAgICAKICAgIGRlZiBkcmF3KHNlbGYpOgogICAgICAgICIiIkRyYXcgdGhlIGdyaWQuIiIiCiAgICAgICAgCiAgICAgICAgdXAoKQogICAgICAgIGNvbG9ycyA9IHswOidkZWVwc2t5Ymx1ZScsIDE6J3JlZCcsIDI6J3llbGxvdycsIDM6J2xpbWVncmVlbicsIDQ6J2JsYWNrJ30KICAgICAgICAKICAgICAgICAjIHdlIGdvIHRocm91Z2ggdGhlIGNvbHVtbnMKICAgICAgICBmb3IgeCBpbiByYW5nZShzZWxmLm0pOgoKICAgICAgICAgICAgIyB3ZSBnbyB0aHJvdWdoIHRoZSBsaW5lcwogICAgICAgICAgICBmb3IgeSBpbiByYW5nZShzZWxmLm4pOgoKICAgICAgICAgICAgICAgIGdvdG8oLXNlbGYueDAgKyB4ICogc2VsZi5kICsgc2VsZi5kIC8vIDIsIHNlbGYueTAgLSB5ICogc2VsZi5kIC0gc2VsZi5kIC8vIDIpCiAgICAgICAgICAgICAgICBjb2wgPSBjb2xvcnNbc2VsZi5zdGF0ZVt5XVt4XV0KCiAgICAgICAgICAgICAgICAjIHRoZSBjZWxsIGlzIGZyZWUgb3IgaXMgZnVsbGVkIGJ5IGEgdG9rZW4KICAgICAgICAgICAgICAgIGlmIGNvbCAhPSAnbGltZWdyZWVuJyBhbmQgY29sICE9ICdibGFjayc6CiAgICAgICAgICAgICAgICAgICAgZG90KHNlbGYuZCAqIDI1IC8vIDMyLCAnYmxhY2snKQogICAgICAgICAgICAgICAgICAgIGRvdChzZWxmLmQgKiAzIC8vIDUsIGNvbCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyB0aGUgY2VsbCBpcyBhIHdpbm5pbmcgY2VsbAogICAgICAgICAgICAgICAgZWxpZiBjb2wgPT0gJ2xpbWVncmVlbic6CiAgICAgICAgICAgICAgICAgICAgZG90KHNlbGYuZCAqIDIgLy8gNSwgY29sKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIHRoZXJlIGlzIGEgZHJhdyAobm8gb25lIGhhcyB3b24pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGRvdChzZWxmLmQgLy8gNCwgY29sKQoKCmNsYXNzIFBsYXllcjoKICAgICIiIkNyZWF0ZSBhIHBsYXllciAod2l0aCBhdHRyaWJ1dGVzIG9ubHkpLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lLCBjb2wpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLmNvbCA9IGNvbAogICAgICAgIHNlbGYuc2NvcmUgPSAwCgoKY2xhc3MgR2FtZToKICAgICIiIlRoaXMgaXMgYSBnZW5lcmFsIEdhbWUgY2xhc3MuCiAgICBJdCBjb250YWlucyBhbGwgdGhlIGdhbWUgdmFyaWFibGVzLCBtZXRob2RzIGFuZCBhdHRyaWJ1dGVzLgogICAgIiIiCiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAiIiJTZXQgdXAgdGhlIGdhbWUgd2luZG93IGFuZCB0aGUgdHVydGxlIGF0dHJpYnV0ZXMuCiAgICAgICAgV3JpdGUgc29tZSBpbmZvcm1hdGlvbnMgb24gdGhlIGNvbnNvbGUuCiAgICAgICAgU3RhcnQgdGhlIG11c2ljLgogICAgICAgIEluaXRpbGl6ZSBhbGwgdGhlIGF0dHJpYnV0ZXMuCiAgICAgICAgU2V0dXAgdGhlIGNhbGxiYWNrIGZ1bmN0aW9ucy4KICAgICAgICAiIiIKICAgICAgICAKICAgICAgICAjIHdpbmRvdyBhbmQgdHVydGxlIHNldCB1cAogICAgICAgIHNldHVwKDYwMCwgNDAwKQogICAgICAgIGhpZGV0dXJ0bGUoKQogICAgICAgIHRyYWNlcigwKQogICAgICAgIHVwKCkKCiAgICAgICAgIyBmaXJzdCBtZXNzYWdlIG9uIHRoZSBzY3JlZW4KICAgICAgICBkb3QoMTUwMCwgJ2RlZXBza3libHVlJykKICAgICAgICB3cml0ZSgnUGxlYXNlIGVudGVyIHRoZSBuYW1lcyBvZlxudGhlIHBsYXllcnMgaW4gdGhlIGNvbnNvbGUnLCBmb250PSgnVGltZXMnLCAzMCksIGFsaWduPSdjZW50ZXInKQogICAgICAgIAoKICAgICAgICAjIHN0cmluZ3MgdG8gZGlzcGxheSBpbiB0aGUgY29uc29sZQogICAgICAgIHRpdGxlID0gJ1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuKiAqICogQ09OTkVDVCA0IChQdWlzc2FuY2UgNCkgKiAqICpcblxuXG4nCiAgICAgICAgcnVsZXMgPSAnR29hbCBvZiB0aGUgZ2FtZSA6XG5cblx0LT4gVGhlIGdvYWwgaXMgdG8gYWxpZ24gNCB0b2tlbnMgb2YgeW91ciBjb2xvdXIgdmVydGljYWxseSwgaG9yaXpvbnRhbGx5IG9yIGRpYWdvbmFsbHkuXG5cblxuJwogICAgICAgIGhvd190b19wbGF5ID0gJ0hvdyB0byBwbGF5ID9cblxuXHQnCiAgICAgICAgdXNpbmdfdGhlX21vdXNlID0gJy0gQnkgdXNpbmcgdGhlIG1vdXNlIDogY2xpY2sgb24gdGhlIGNvbHVtbiB5b3Ugd2FudCB0byBwbGF5IGluLlxuXHQnCiAgICAgICAgdXNpbmdfdGhlX2tleWJvYXJkID0gJy0gQnkgdXNpbmcgdGhlIGtleWJvYXJkIDogdXNlIHRoZSBrZXlzIDEgdG8gNyB0byBwbGF5IGluIHRoZSByZXNwZWN0aXZlIGNvbHVtbi5cblxuXG4nCiAgICAgICAgZG9udF9wbGF5X2Zhc3QgPSAnISEhIFdBUk5JTkcgISEhIDogZG9uXCd0IHBsYXkgdG9vIGZhc3QsIG9yIGxpZ2h0bmluZyB3aWxsIGZhbGwgb24geW91XG5cblxuJwogICAgICAgIGJ1dHRvbnNfZGVmaW5pdGlvbiA9ICdCdXR0b25zIChhbmQga2V5Ym9hcmQgc2hvcnRjdXRzKSA6XG5cblx0ICBOYW1lXHRcdEFjdGlvblx0XHRcdFx0XHRcdEtleWJvYXJkIHNob3J0Y3V0XG5cblx0JwogICAgICAgIGJ1dHRvbl91bmRvX25ldyA9ICctIFVuZG9cdFx0LT4gY2FuY2VsIHRoZSBsYXN0IG1vdmVcdFx0XHRcdERlbGV0ZVxuXHQtIE5ld1x0XHQtPiBjcmVhdGUgYSBuZXcgZ2FtZSBieSBjbGVhcmluZyB0aGUgYm9hcmRcdFRhYnVsYXRpb25cblx0JwogICAgICAgIGJ1dHRvbl9yZXNldCA9ICctIFJlc2V0IGFsbFx0LT4gcmVzZXQgdGhlIHNjb3JlcywgY2xlYXIgdGhlIGJvYXJkLFx0XHRSXG5cdFx0XHQgICBvbmx5IHRoZSBuYW1lcyBhcmUgcHJlc2VydmVkXG5cdCcKICAgICAgICBidXR0b25fcXVpdF9jbG9zZSA9ICctIFFVSVRcdFx0LT4gcXVpdCB0aGUgZ2FtZVx0XHRcdFx0UVxuXHQtIENMT1NFXHRcdC0+IGNsb3NlIHRoZSB3aW5kb3dcdFx0XHRcdFhcblxuXG5cbicKICAgICAgICBiZWZvcmVfc3RhcnRpbmcgPSAnQmVmb3JlIHN0YXJ0aW5nLCBwbGVhc2UgZW50ZXIgdGhlIG5hbWVzIG9mIHRoZSBwbGF5ZXJzIDpcbicKICAgICAgICBwcmludCh0aXRsZSArIHJ1bGVzICsgaG93X3RvX3BsYXkgKyB1c2luZ190aGVfbW91c2UgKyB1c2luZ190aGVfa2V5Ym9hcmQgKyBkb250X3BsYXlfZmFzdCArCiAgICAgICAgICAgIGJ1dHRvbnNfZGVmaW5pdGlvbiArIGJ1dHRvbl91bmRvX25ldyArIGJ1dHRvbl9yZXNldCArIGJ1dHRvbl9xdWl0X2Nsb3NlICsgYmVmb3JlX3N0YXJ0aW5nKQoKICAgICAgICAjIGlucHV0IGZvciB0aGUgbmFtZXMgb2YgdGhlIHBsYXllcnMKICAgICAgICBpbnB1dF9wbGF5ZXIxID0gaW5wdXQoJ1x0TmFtZSBvZiB0aGUgZmlyc3QgcGxheWVyIDogJykKICAgICAgICBpbnB1dF9wbGF5ZXIyID0gaW5wdXQoJ1xuXHROYW1lIG9mIHRoZSBzZWNvbmQgcGxheWVyIDogJykKCiAgICAgICAgcHJpbnQoJ1xuTmFtZXMgcmVnaXN0ZXJlZCAhIFlvdSBjYW4gbm93IHBsYXkgb24gdGhlIGdhbWVcJ3Mgc2NyZWVuLlxuXG5cbkhhdmUgYSBnb29kIGdhbWUgOilcblxuJykKCgogICAgICAgICMgbG9hZCB0aGUgbXVzaWMKICAgICAgICBpbml0KCkKICAgICAgICBmaWxlRGlyID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGgucmVhbHBhdGgoJ19fZmlsZV9fJykpCiAgICAgICAgIyBwcmludChmaWxlRGlyKQogICAgICAgIGZpbGVuYW1lID0gb3MucGF0aC5qb2luKGZpbGVEaXIsICdzcmMvcHJvamV0L3Byb2pldDcvY29ubmVjdF80X2F1ZGlvLm1wMycpICAgICAgIAogICAgICAgIG11c2ljLmxvYWQoZmlsZW5hbWUpCgogICAgICAgICMgcGxheSB0aGUgbXVzaWMgKC0xIDw9PiBpbmZpbml0ZSBsb29wKQogICAgICAgIG11c2ljLnBsYXkoLTEpCiAgICAgICAgCgogICAgICAgICMgaW5pdGlhbGl6YXRpb24gb2YgdGhlIGF0dHJpYnV0ZXMgOiBjcmVhdGlvbiBvZiBvYmplY3RzCgogICAgICAgICMgZ3JpZCBhbmQgdGV4dHMKICAgICAgICBzZWxmLmdyaWQgPSBHcmlkKCkKICAgICAgICBzZWxmLnRpdGxlID0gVGV4dCgoMCwgIDE2OCksICdDb25uZWN0IDQnLCBzaXplPTI0LCBjb2w9J2JsYWNrJykKICAgICAgICBzZWxmLmF1dGhvciA9IFRleHQoKDI4NSwgLTE5MCksICdieSBFbWlsaWVuIEJhcmRlJywgYWxpZ249J3JpZ2h0JykKICAgICAgICBzZWxmLmNvbHVtbnNfbmFtZSA9IFRleHQoKDAsIC0xNTApLCAnIDEgICAgICAgICAyICAgICAgICAgMyAgICAgICAgIDQgICAgICAgICA1ICAgICAgICAgNiAgICAgICAgIDcnLCBzaXplPScxNScsIGNvbD0nd2hpdGUnKQogICAgICAgIAogICAgICAgICMgYnV0dG9ucwogICAgICAgIHNlbGYuYnRfdW5kbyA9IEJ1dHRvbigoMjAwLCAxMDApLCAnVW5kbycpCiAgICAgICAgc2VsZi5idF9uZXcgPSBCdXR0b24oKDIwMCwgNTApLCAnTmV3JykKICAgICAgICBzZWxmLmJ0X3Jlc2V0X3Njb3JlcyA9IEJ1dHRvbigoMjAwLCAwKSwgJ1Jlc2V0IGFsbCcpCiAgICAgICAgc2VsZi5idF9xdWl0ID0gQnV0dG9uKCgyMDAsIC01MCksICdRVUlUJywgY29sb3I9J3NsYXRlZ3JleScpCiAgICAgICAgc2VsZi5idF9jbG9zZSA9IEJ1dHRvbigoLTgwLCAtNjApLCAnQ0xPU0UnLCAoMTYwLCA2MCksIGNvbG9yPSdyZWQnLCBkaXNwbGF5ZWQ9RmFsc2UpCiAgICAgICAgCiAgICAgICAgIyBwbGF5ZXJzCiAgICAgICAgc2VsZi5wbGF5ZXIxID0gUGxheWVyKGlucHV0X3BsYXllcjEsICdyZWQnKQogICAgICAgIHNlbGYucGxheWVyMiA9IFBsYXllcihpbnB1dF9wbGF5ZXIyLCAneWVsbG93JykKICAgICAgICAKICAgICAgICAjIGVyYXNhYmxlcyB0ZXh0IChyZWN0YW5nbGVzIGFyZSB1c2VkIHRvIGVyYXNlIG9sZCB0ZXh0KQogICAgICAgIHNlbGYuc2NvcmVzID0gVGV4dCgoLTI4MCwgNTApLCBmJ1Njb3JlcyA6XG5cbntzZWxmLnBsYXllcjEubmFtZX0gOiB7c2VsZi5wbGF5ZXIxLnNjb3JlfVxuXG57c2VsZi5wbGF5ZXIyLm5hbWV9IDoge3NlbGYucGxheWVyMi5zY29yZX0nLCBhbGlnbj0nbGVmdCcpCiAgICAgICAgc2VsZi5zY29yZXNfZXJhc2VyID0gUmVjdGFuZ2xlKChzZWxmLnNjb3Jlcy5wb3NbMF0gLSA1LCBzZWxmLnNjb3Jlcy5wb3NbMV0gLSAxMCksICgxMDAsIDEwMCksIGNvbG9yPSdkZWVwc2t5Ymx1ZScsIG91dGxpbmU9RmFsc2UpCiAgICAgICAgc2VsZi53aW5fbWVzc2FnZSA9IFRleHQoKC0yODUsIC04MCksICdOb2JvZHkgd2luICEhIScsIHNpemU9MTgsIGFsaWduPSdsZWZ0JykKICAgICAgICBzZWxmLndpbl9tZXNzYWdlX2VyYXNlciA9IFJlY3RhbmdsZShzZWxmLndpbl9tZXNzYWdlLnBvcywgKDEwMCwgMTAwKSwgY29sb3I9J2RlZXBza3libHVlJywgb3V0bGluZT1GYWxzZSkKICAgICAgICBzZWxmLnN0YXR1cyA9IFRleHQoKC0yODUsIC0xOTApLCBmJ3tzZWxmLnBsYXllcjEubmFtZX0gKHtzZWxmLnBsYXllcjEuY29sfSkgdG8gbW92ZScsIGFsaWduPSdsZWZ0JykKICAgICAgICBzZWxmLnN0YXR1c19lcmFzZXIgPSBSZWN0YW5nbGUoKHNlbGYuc3RhdHVzLnBvc1swXSAtIDUsIHNlbGYuc3RhdHVzLnBvc1sxXSksICg0NTAsIDIwKSwgY29sb3I9J2RlZXBza3libHVlJywgb3V0bGluZT1GYWxzZSkKICAgICAgICAKCiAgICAgICAgIyBpbml0aWFsaXphdGlvbiBvZiB0aGUgYXR0cmlidXRlcyA6IG90aGVyIHR5cGVzIG9mIHZhcmlhYmxlcwogICAgICAgIHNlbGYucGxheWVycyA9IChzZWxmLnBsYXllcjEsIHNlbGYucGxheWVyMikKICAgICAgICBzZWxmLmN1cnJlbnRfcGxheWVyID0gMQogICAgICAgIHNlbGYubW92ZXMgPSAwCiAgICAgICAgc2VsZi5wbGF5aW5nID0gVHJ1ZQogICAgICAgIHNlbGYubm9fd2lubmVyID0gRmFsc2UKICAgICAgICBzZWxmLmhpc3RvcnkgPSBbXQogICAgICAgIHNlbGYucnVuID0gVHJ1ZQoKCiAgICAgICAgIyBnYW1lIGluaXRpYWxpemF0aW9uCiAgICAgICAgc2VsZi5yZXNldCgpCgoKICAgICAgICAjIGNhbGwgYmFjayBmdW5jdGlvbnMKICAgICAgICBzID0gZ2V0c2NyZWVuKCkKCiAgICAgICAgIyB3aGVuIHRoZSBwbGF5ZXIgdXNlcyB0aGUgbW91c2UKICAgICAgICBzLm9uY2xpY2soc2VsZi5jbGljaykKCiAgICAgICAgIyB3aGVuIHRoZSBwbGF5ZXIgdXNlcyB0aGUga2V5Ym9hcmQKICAgICAgICBpZiBzZWxmLnJ1bjoKCiAgICAgICAgICAgICMgdGVzdCB0aGUga2V5cyBmcm9tIDEgdG8gNwogICAgICAgICAgICBmb3IgbnVtIGluIHJhbmdlKDEsIDgpOgogICAgICAgICAgICAgICAgcy5vbmtleShsYW1iZGEgY29sdW1uPW51bSA6IHNlbGYucGxheShjb2x1bW4gLSAxKSwgbnVtKQogICAgICAgICAgICAKICAgICAgICAgICAgIyB0ZXN0IG90aGVyIHNwZWNpZmljcyBrZXlzCiAgICAgICAgICAgIHMub25rZXkobGFtYmRhOnNlbGYudW5kbygpLCAnQmFja1NwYWNlJykKICAgICAgICAgICAgcy5vbmtleShsYW1iZGE6c2VsZi5yZXNldCgpLCAnVGFiJykKICAgICAgICAgICAgcy5vbmtleShsYW1iZGE6c2VsZi5yZXNldF9zY29yZXMoKSwgJ3InKQogICAgICAgICAgICBzLm9ua2V5KGxhbWJkYTpzZWxmLnF1aXQoKSwgJ3EnKQogICAgICAgIAogICAgICAgIHMub25rZXkobGFtYmRhOnF1aXQoKSwgJ3gnKQoKCiAgICAgICAgcy5saXN0ZW4oKQogICAgCiAgICAKICAgIGRlZiBib2FyZChzZWxmKToKICAgICAgICAiIiJEcmF3IHRoZSBiYWNrZ3JvdW5kLCB0aGUgZGFya2JsdWUgYm9hcmQKICAgICAgICBhbmQgdGhlIG5hbWUgb2YgdGhlIGNvbHVtbnMuIiIiCiAgICAgICAgCiAgICAgICAgaG9tZSgpCiAgICAgICAgCiAgICAgICAgIyBiYWNrZ3JvdW5kCiAgICAgICAgZG90KDIwMDAsICdkZWVwc2t5Ymx1ZScpCgogICAgICAgICMgYm9hcmQsIGluaXRpYWxpemF0aW9uIG9mIHRoZSB0dXJ0bGUKICAgICAgICBnb3RvKC1zZWxmLmdyaWQueDAgKyBzZWxmLmdyaWQuZCAvLyAyLCBzZWxmLmdyaWQueTAgKyBzZWxmLmdyaWQuZCAvLyAyKQogICAgICAgIGNvbG9yKCdibGFjaycpCiAgICAgICAgZmlsbGNvbG9yKCduYXZ5JykKICAgICAgICBwZW5zaXplKDgpCiAgICAgICAgZG93bigpCiAgICAgICAgYmVnaW5fZmlsbCgpCgogICAgICAgICMgQm9hcmQncyBkcmF3aW5nCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMik6CiAgICAgICAgICAgIGZvcndhcmQoMiAqIHNlbGYuZ3JpZC54MCAtIHNlbGYuZ3JpZC5kKQogICAgICAgICAgICBjaXJjbGUoLXNlbGYuZ3JpZC5kLCA5MCkKICAgICAgICAgICAgZm9yd2FyZCgyICogc2VsZi5ncmlkLnkwIC0gc2VsZi5ncmlkLmQpCiAgICAgICAgICAgIGNpcmNsZSgtc2VsZi5ncmlkLmQsIDkwKQogICAgICAgIAogICAgICAgIGVuZF9maWxsKCkKICAgICAgICB1cCgpCgogICAgICAgICMgd3JpdGluZyBvZiB0aGUgY29sdW1uJ3MgbmFtZQogICAgICAgIHNlbGYuY29sdW1uc19uYW1lLmRyYXcoKQoKCiAgICBkZWYgc3dpdGNoX3BsYXllcnMoc2VsZik6CiAgICAgICAgIiIiU3dpdGNoIHRoZSBjdXJyZW50IHBsYXllciBhbmQgdGhlIGdhbWUncyBzdGF0dXMuIiIiCiAgICAgICAgCiAgICAgICAgIyBzd2l0Y2ggdGhlIGN1cnJlbnQgcGxheWVyCiAgICAgICAgc2VsZi5jdXJyZW50X3BsYXllciA9IHNlbGYuY3VycmVudF9wbGF5ZXIgJSAyICsgMQoKICAgICAgICAjIHN3aXRjaCB0aGUgZ2FtZSdzIHN0YXR1cwogICAgICAgIHBsYXllciA9IHNlbGYucGxheWVyc1tzZWxmLmN1cnJlbnRfcGxheWVyIC0gMV0gICMgdG8gc2ltcGxpZnkgdGhlIG5leHQgbGluZQogICAgICAgIHNlbGYuc3RhdHVzLnRleHQgPSBmJ3twbGF5ZXIubmFtZX0gKHtwbGF5ZXIuY29sfSkgdG8gbW92ZScKICAgIAogICAgCiAgICBkZWYgY2hlY2tfd2luKHNlbGYpOgogICAgICAgICIiIkNoZWNrIGlmIGEgcGxheWVyIGhhcyB3b24gYnkgbGluaW5nIHVwIDQgdG9rZW5zLiIiIgogICAgICAgIAogICAgICAgIHNlbGYuZHJhdygpCgogICAgICAgICMgc29tZSB1c2VmdWwgbGlzdHMKICAgICAgICB3aW5uaW5nX2NlbGxzID0gW10KICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzID0gW10KCiAgICAgICAgCiAgICAgICAgIyBjaGVjayB0aGUgY29sdW1ucwogICAgICAgIGZvciBjb2x1bW4gaW4gcmFuZ2UoNyk6CiAgICAgICAgICAgIGZvciBsaW5lIGluIHJhbmdlKDYpOgogICAgICAgICAgICAgICAgY2VsbF90ZXN0ID0gc2VsZi5ncmlkLnN0YXRlW2xpbmVdW2NvbHVtbl0KCiAgICAgICAgICAgICAgICAjIHdlIGFkZCBhIHRva2VuICh0aGUgdmFsdWUgb2YgdGhlIGNlbGxfdGVzdCkgdG8gdGhlIGxpc3QKICAgICAgICAgICAgICAgIGlmIGNlbGxfdGVzdCA9PSAxIG9yIGNlbGxfdGVzdCA9PSAyOgogICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY2VsbHMuYXBwZW5kKGNlbGxfdGVzdCkKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzLmFwcGVuZChbbGluZSwgY29sdW1uXSkKCiAgICAgICAgICAgICAgICAgICAgIyB3ZSByZW1vdmUgc29tZSB0b2tlbnMgaWYgdGhleSBhcmUgbm90IGFsbCBpZGVudGljYWwKICAgICAgICAgICAgICAgICAgICB3aGlsZSB3aW5uaW5nX2NlbGxzLmNvdW50KHdpbm5pbmdfY2VsbHNbMF0pICE9IGxlbih3aW5uaW5nX2NlbGxzKToKICAgICAgICAgICAgICAgICAgICAgICAgd2lubmluZ19jZWxscy5wb3AoMCkKICAgICAgICAgICAgICAgICAgICAgICAgd2lubmluZ19jb29yZGluYXRlcy5wb3AoMCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgd2UgY2hlY2sgaWYgdGhlcmUgaXMgNCBpZGVudGljYWwgd2lubmluZyBjZWxscwogICAgICAgICAgICAgICAgICAgIGlmIGxlbih3aW5uaW5nX2NlbGxzKSA9PSA0OgogICAgICAgICAgICAgICAgICAgICAgICAjIHdlIHVzZSB0aGUgY29vcmRpbmF0ZXMgb2YgdGhlIHdpbm5pbmcgY2VsbHMgdG8gY2hhbmdlIHRoZSBncmlkJ3Mgc3RhdGUKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNvb3JkaW5hdGVzIGluIHdpbm5pbmdfY29vcmRpbmF0ZXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdyaWQuc3RhdGVbY29vcmRpbmF0ZXNbMF1dW2Nvb3JkaW5hdGVzWzFdXSA9IDMKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbGF5aW5nID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kcmF3KCkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBpZiB0aGUgY2VsbCBpcyBlbXB0eSAobm8gdG9rZW4pLCB3ZSBjbGVhciBib3RoIGxpc3RzCiAgICAgICAgICAgICAgICBpZiBjZWxsX3Rlc3QgPT0gMDoKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2NlbGxzLmNsZWFyKCkKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzLmNsZWFyKCkKCiAgICAgICAgICAgICMgaWYgc29tZW9uZSBoYXMgd29uLCB3ZSBzdG9wIGNoZWNraW5nIHRoZSByZXN0IG9mIHRoZSBib2FyZAogICAgICAgICAgICBpZiBub3Qgc2VsZi5wbGF5aW5nOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgCiAgICAgICAgICAgICMgYmVmb3JlIG1vdmluZyBvbiB0byB0aGUgbmV4dCBjb2x1bW4sIHdlIGNsZWFyIGJvdGggbGlzdHMKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHdpbm5pbmdfY2VsbHMuY2xlYXIoKQogICAgICAgICAgICAgICAgd2lubmluZ19jb29yZGluYXRlcy5jbGVhcigpCgoKICAgICAgICAjIGNoZWNrIHRoZSBsaW5lcwogICAgICAgIGZvciBsaW5lIGluIHJhbmdlKDYpOgogICAgICAgICAgICBmb3IgY29sdW1uIGluIHJhbmdlKDcpOgogICAgICAgICAgICAgICAgY2VsbF90ZXN0ID0gc2VsZi5ncmlkLnN0YXRlW2xpbmVdW2NvbHVtbl0KCiAgICAgICAgICAgICAgICAjIHdlIGFkZCBhIHRva2VuICh0aGUgdmFsdWUgb2YgdGhlIGNlbGxfdGVzdCkgdG8gdGhlIGxpc3QKICAgICAgICAgICAgICAgIGlmIGNlbGxfdGVzdCA9PSAxIG9yIGNlbGxfdGVzdCA9PSAyOgogICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY2VsbHMuYXBwZW5kKGNlbGxfdGVzdCkKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzLmFwcGVuZChbbGluZSwgY29sdW1uXSkKCiAgICAgICAgICAgICAgICAgICAgIyB3ZSByZW1vdmUgc29tZSB0b2tlbnMgaWYgdGhleSBhcmUgbm90IGFsbCBpZGVudGljYWwKICAgICAgICAgICAgICAgICAgICB3aGlsZSB3aW5uaW5nX2NlbGxzLmNvdW50KHdpbm5pbmdfY2VsbHNbMF0pICE9IGxlbih3aW5uaW5nX2NlbGxzKToKICAgICAgICAgICAgICAgICAgICAgICAgd2lubmluZ19jZWxscy5wb3AoMCkKICAgICAgICAgICAgICAgICAgICAgICAgd2lubmluZ19jb29yZGluYXRlcy5wb3AoMCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgd2UgY2hlY2sgaWYgdGhlcmUgaXMgNCBpZGVudGljYWwgd2lubmluZyBjZWxscwogICAgICAgICAgICAgICAgICAgIGlmIGxlbih3aW5uaW5nX2NlbGxzKSA9PSA0OgogICAgICAgICAgICAgICAgICAgICAgICAjIHdlIHVzZSB0aGUgY29vcmRpbmF0ZXMgb2YgdGhlIHdpbm5pbmcgY2VsbHMgdG8gY2hhbmdlIHRoZSBncmlkJ3Mgc3RhdGUKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNvb3JkaW5hdGVzIGluIHdpbm5pbmdfY29vcmRpbmF0ZXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdyaWQuc3RhdGVbY29vcmRpbmF0ZXNbMF1dW2Nvb3JkaW5hdGVzWzFdXSA9IDMKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbGF5aW5nID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kcmF3KCkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBpZiB0aGUgY2VsbCBpcyBlbXB0eSAobm8gdG9rZW4pLCB3ZSBjbGVhciBib3RoIGxpc3RzCiAgICAgICAgICAgICAgICBpZiBjZWxsX3Rlc3QgPT0gMDoKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2NlbGxzLmNsZWFyKCkKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzLmNsZWFyKCkKCiAgICAgICAgICAgICMgaWYgc29tZW9uZSBoYXMgd29uLCB3ZSBzdG9wIGNoZWNraW5nIHRoZSByZXN0IG9mIHRoZSBib2FyZAogICAgICAgICAgICBpZiBub3Qgc2VsZi5wbGF5aW5nOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgCiAgICAgICAgICAgICMgYmVmb3JlIG1vdmluZyBvbiB0byB0aGUgbmV4dCBsaW5lLCB3ZSBjbGVhciBib3RoIGxpc3RzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB3aW5uaW5nX2NlbGxzLmNsZWFyKCkKICAgICAgICAgICAgICAgIHdpbm5pbmdfY29vcmRpbmF0ZXMuY2xlYXIoKQogICAgICAgIAoKICAgICAgICAjIGNoZWNrIHRoZSBmaXJzdCBkaWFnb25hbHMKICAgICAgICBmb3IgZGlhZ29uYWwgaW4gcmFuZ2UoMTIpOgogICAgICAgICAgICBjb2xfbnVtID0gbWF4KDAsIGRpYWdvbmFsIC0gNykgIyAwIMOgIDcKICAgICAgICAgICAgbGluZV9udW0gPSBtaW4oZGlhZ29uYWwsIDYpICMgZGUgMCDDoCA2CiAgICAgICAgICAgICMgcHJpbnQoZidkaWFnb25hbCA6IHtkaWFnb25hbH0gLSBjb2xfbnVtIDoge2NvbF9udW19IC0gbGluZV9udW0gOiB7bGluZV9udW19JykKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKGNvbF9udW0sIGxpbmVfbnVtKToKICAgICAgICAgICAgICAgICMgcHJpbnQoaSwgZGlhZ29uYWwgLSBpIC0gMSkKICAgICAgICAgICAgICAgIGNlbGxfdGVzdCA9IHNlbGYuZ3JpZC5zdGF0ZVtpXVtkaWFnb25hbCAtIGkgLSAxXQoKICAgICAgICAgICAgICAgICMgd2UgYWRkIGEgdG9rZW4gKHRoZSB2YWx1ZSBvZiB0aGUgY2VsbF90ZXN0KSB0byB0aGUgbGlzdAogICAgICAgICAgICAgICAgaWYgY2VsbF90ZXN0ID09IDEgb3IgY2VsbF90ZXN0ID09IDI6CiAgICAgICAgICAgICAgICAgICAgd2lubmluZ19jZWxscy5hcHBlbmQoY2VsbF90ZXN0KQogICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY29vcmRpbmF0ZXMuYXBwZW5kKFtpLCBkaWFnb25hbCAtIGkgLSAxXSkKCiAgICAgICAgICAgICAgICAgICAgIyB3ZSByZW1vdmUgc29tZSB0b2tlbnMgaWYgdGhleSBhcmUgbm90IGFsbCBpZGVudGljYWwKICAgICAgICAgICAgICAgICAgICB3aGlsZSB3aW5uaW5nX2NlbGxzLmNvdW50KHdpbm5pbmdfY2VsbHNbMF0pICE9IGxlbih3aW5uaW5nX2NlbGxzKToKICAgICAgICAgICAgICAgICAgICAgICAgd2lubmluZ19jZWxscy5wb3AoMCkKICAgICAgICAgICAgICAgICAgICAgICAgd2lubmluZ19jb29yZGluYXRlcy5wb3AoMCkKCiAgICAgICAgICAgICAgICAgICAgIyB3ZSBjaGVjayBpZiB0aGVyZSBpcyA0IGlkZW50aWNhbCB3aW5uaW5nIGNlbGxzCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHdpbm5pbmdfY2VsbHMpID09IDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICMgd2UgdXNlIHRoZSBjb29yZGluYXRlcyBvZiB0aGUgd2lubmluZyBjZWxscyB0byBjaGFuZ2UgdGhlIGdyaWQncyBzdGF0ZQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgY29vcmRpbmF0ZXMgaW4gd2lubmluZ19jb29yZGluYXRlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JpZC5zdGF0ZVtjb29yZGluYXRlc1swXV1bY29vcmRpbmF0ZXNbMV1dID0gMwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBsYXlpbmcgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRyYXcoKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIGlmIHRoZSBjZWxsIGlzIGVtcHR5IChubyB0b2tlbiksIHdlIGNsZWFyIGJvdGggbGlzdHMKICAgICAgICAgICAgICAgIGlmIGNlbGxfdGVzdCA9PSAwOgogICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY2VsbHMuY2xlYXIoKQogICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY29vcmRpbmF0ZXMuY2xlYXIoKQoKICAgICAgICAgICAgIyBpZiBzb21lb25lIGhhcyB3b24sIHdlIHN0b3AgY2hlY2tpbmcgdGhlIHJlc3Qgb2YgdGhlIGJvYXJkCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLnBsYXlpbmc6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAKICAgICAgICAgICAgIyBiZWZvcmUgbW92aW5nIG9uIHRvIHRoZSBuZXh0IGRpYWdvbmFsLCB3ZSBjbGVhciBib3RoIGxpc3RzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB3aW5uaW5nX2NlbGxzLmNsZWFyKCkKICAgICAgICAgICAgICAgIHdpbm5pbmdfY29vcmRpbmF0ZXMuY2xlYXIoKQogICAgICAgIAoKICAgICAgICAjIGNoZWNrIHRoZSBzZWNvbmQgZGlhZ29uYWxzCiAgICAgICAgZm9yIGRpYWdvbmFsIGluIHJhbmdlKDEyKToKICAgICAgICAgICAgY29sX251bSA9IG1heCgwLCA1IC0gZGlhZ29uYWwpCiAgICAgICAgICAgIGxpbmVfbnVtID0gbWluKDEyIC0gZGlhZ29uYWwsIDYpCiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShjb2xfbnVtLCBsaW5lX251bSk6CiAgICAgICAgICAgICAgICAjIHByaW50KGksIGkgKyBkaWFnb25hbCAtIDUpCiAgICAgICAgICAgICAgICBjZWxsX3Rlc3QgPSBzZWxmLmdyaWQuc3RhdGVbaV1baSArIGRpYWdvbmFsIC0gNV0KCiAgICAgICAgICAgICAgICAjIHdlIGFkZCBhIHRva2VuICh0aGUgdmFsdWUgb2YgdGhlIGNlbGxfdGVzdCkgdG8gdGhlIGxpc3QKICAgICAgICAgICAgICAgIGlmIGNlbGxfdGVzdCA9PSAxIG9yIGNlbGxfdGVzdCA9PSAyOgogICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY2VsbHMuYXBwZW5kKGNlbGxfdGVzdCkKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzLmFwcGVuZChbaSwgaSArIGRpYWdvbmFsIC0gNV0pCgogICAgICAgICAgICAgICAgICAgICMgd2UgcmVtb3ZlIHNvbWUgdG9rZW5zIGlmIHRoZXkgYXJlIG5vdCBhbGwgaWRlbnRpY2FsCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgd2lubmluZ19jZWxscy5jb3VudCh3aW5uaW5nX2NlbGxzWzBdKSAhPSBsZW4od2lubmluZ19jZWxscyk6CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY2VsbHMucG9wKDApCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbm5pbmdfY29vcmRpbmF0ZXMucG9wKDApCgogICAgICAgICAgICAgICAgICAgICMgd2UgY2hlY2sgaWYgdGhlcmUgaXMgNCBpZGVudGljYWwgd2lubmluZyBjZWxscwogICAgICAgICAgICAgICAgICAgIGlmIGxlbih3aW5uaW5nX2NlbGxzKSA9PSA0OgogICAgICAgICAgICAgICAgICAgICAgICAjIHdlIHVzZSB0aGUgY29vcmRpbmF0ZXMgb2YgdGhlIHdpbm5pbmcgY2VsbHMgdG8gY2hhbmdlIHRoZSBncmlkJ3Mgc3RhdGUKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNvb3JkaW5hdGVzIGluIHdpbm5pbmdfY29vcmRpbmF0ZXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdyaWQuc3RhdGVbY29vcmRpbmF0ZXNbMF1dW2Nvb3JkaW5hdGVzWzFdXSA9IDMKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbGF5aW5nID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kcmF3KCkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBpZiB0aGUgY2VsbCBpcyBlbXB0eSAobm8gdG9rZW4pLCB3ZSBjbGVhciBib3RoIGxpc3RzCiAgICAgICAgICAgICAgICBpZiBjZWxsX3Rlc3QgPT0gMDoKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2NlbGxzLmNsZWFyKCkKICAgICAgICAgICAgICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzLmNsZWFyKCkKCiAgICAgICAgICAgICMgaWYgc29tZW9uZSBoYXMgd29uLCB3ZSBzdG9wIGNoZWNraW5nIHRoZSByZXN0IG9mIHRoZSBib2FyZAogICAgICAgICAgICBpZiBub3Qgc2VsZi5wbGF5aW5nOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgCiAgICAgICAgICAgICMgYmVmb3JlIG1vdmluZyBvbiB0byB0aGUgbmV4dCBkaWFnb25hbCwgd2UgY2xlYXIgYm90aCBsaXN0cwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgd2lubmluZ19jZWxscy5jbGVhcigpCiAgICAgICAgICAgICAgICB3aW5uaW5nX2Nvb3JkaW5hdGVzLmNsZWFyKCkKCgogICAgICAgICMgdGhlIGJvYXJkIGlzIGZ1bGwKICAgICAgICBpZiBzZWxmLm1vdmVzID09IDYgKiA3OgogICAgICAgICAgICBzZWxmLm5vX3dpbm5lciA9IFRydWUKCiAgICAgICAgICAgICMgYWxsIGNlbGxzIHRha2UgdGhlIHZhbHVlIG9mIDQgKHdoaWNoIG1lYW5zIHRoZXJlIGlzIG5vIHdpbm5lcikKICAgICAgICAgICAgZm9yIGxpbmUgaW4gcmFuZ2Uoc2VsZi5ncmlkLm4pOgogICAgICAgICAgICAgICAgZm9yIGNlbGwgaW4gcmFuZ2Uoc2VsZi5ncmlkLm0pOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZ3JpZC5zdGF0ZVtsaW5lXVtjZWxsXSA9IDQKICAgICAgICAgICAgCiAgICAgICAgICAgICMgd2UgZXJhc2UgdGhlIG9sZCB3aW4gbWVzc2FnZSwgdXBkYXRlIGl0IGFuZCBkaXNwbGF5IGl0CiAgICAgICAgICAgIHNlbGYud2luX21lc3NhZ2VfZXJhc2VyLmRyYXcoKQogICAgICAgICAgICBzZWxmLndpbl9tZXNzYWdlLnRleHQgPSBmJyogICogICogICogICpcbk5vYm9keVxuV0lOICEhIVxuKiAgKiAgKiAgKiAgKicKICAgICAgICAgICAgc2VsZi53aW5fbWVzc2FnZS5kcmF3KCkKCiAgICAgICAgICAgICMgd2UgZXJhc2UgdGhlIGdhbWUncyBzdGF0dXMgKG5vIG9uZSBpcyBwbGF5aW5nKQogICAgICAgICAgICBzZWxmLnN0YXR1c19lcmFzZXIuZHJhdygpCiAgICAgICAgICAgIAogICAgICAgICAgICBzZWxmLnBsYXlpbmcgPSBGYWxzZQoKICAgICAgICAgICAgc2VsZi5kcmF3KCkKCgogICAgZGVmIHVuZG8oc2VsZik6CiAgICAgICAgIiIiQ2FuY2VsIHRoZSBsYXN0IG1vdmUuIiIiCgogICAgICAgIHNlbGYuc3dpdGNoX3BsYXllcnMoKQoKICAgICAgICAjIHdoZW4gc29tZW9uZSBoYXMgd29uIChvciB0aGVyZSB3YXMgYSBkcmF3KQogICAgICAgIGlmIG5vdCBzZWxmLnBsYXlpbmc6CgogICAgICAgICAgICAjIGlmIHRoZXJlIHdhcyBhIGRyYXcKICAgICAgICAgICAgaWYgc2VsZi5ub193aW5uZXI6CiAgICAgICAgICAgICAgICBzZWxmLm5vX3dpbm5lciA9IEZhbHNlCiAgICAgICAgICAgIAogICAgICAgICAgICAjIGlmIHNvbWVvbmUgaGFzIHdvbgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5wbGF5ZXJzW3NlbGYuY3VycmVudF9wbGF5ZXIgLSAxXS5zY29yZSAtPSAxCiAgICAgICAgICAgIAoKICAgICAgICAgICAgIyB3ZSBlcmFzZSB0aGUgd2luIG1lc3NhZ2UKICAgICAgICAgICAgc2VsZi53aW5fbWVzc2FnZV9lcmFzZXIuZHJhdygpCgogICAgICAgICAgICAjIHdlIGVyYXNlIHRoZSBvbGQgc2NvcmVzLCB1cGRhdGUgaXQgYW5kIGRpc3BsYXkgaXQKICAgICAgICAgICAgc2VsZi5zY29yZXNfZXJhc2VyLmRyYXcoKQogICAgICAgICAgICBzZWxmLnNjb3Jlcy50ZXh0ID0gZidTY29yZXMgOlxuXG57c2VsZi5wbGF5ZXIxLm5hbWV9IDoge3NlbGYucGxheWVyMS5zY29yZX1cblxue3NlbGYucGxheWVyMi5uYW1lfSA6IHtzZWxmLnBsYXllcjIuc2NvcmV9JwogICAgICAgICAgICBzZWxmLnNjb3Jlcy5kcmF3KCkKCiAgICAgICAgICAgIHNlbGYucGxheWluZyA9IFRydWUKICAgICAgICAKICAgICAgICAjIHdoZW4gdGhlcmUgaXMgb25seSBvbmUgbW92ZSBwbGF5ZWQKICAgICAgICBpZiBsZW4oc2VsZi5oaXN0b3J5KSA8PSAyOgogICAgICAgICAgICAjIHdlIHJlc2V0IHRoZSBnYW1lCiAgICAgICAgICAgIHNlbGYucmVzZXQoKQoKICAgICAgICAjIHdoZW4gdGhlcmUgd2FzIG1vcmUgdGhhbiBvbmUgbW92ZSBwbGF5ZWQKICAgICAgICBlbHNlOgogICAgICAgICAgICBsYXN0X3N0YXRlID0gW10KCiAgICAgICAgICAgICMgd2UgZ28gdGhyb3VnaCBsaW5lcyBhbmQgY29sdW1ucwogICAgICAgICAgICBmb3IgbGluZSBpbiByYW5nZSg2KToKICAgICAgICAgICAgICAgIGxhc3RfY2VsbHMgPSBbXQoKICAgICAgICAgICAgICAgIGZvciBjZWxsIGluIHJhbmdlKDcpOgogICAgICAgICAgICAgICAgICAgICMgdGhlIGNlbGxzIG9mIG9uZSBjb2x1bW4gYXJlIGFkZGVkIHRvIHRoZSB0ZW1wb3JhcnkgY2VsbHMncyBsaXN0CiAgICAgICAgICAgICAgICAgICAgbGFzdF9jZWxscy5hcHBlbmQoaW50KHNlbGYuaGlzdG9yeVstMl1bbGluZV1bY2VsbF0pKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIHRoZSBsaW5lIGlzIGFkZGVkIHRvIHRoZSB0ZW1wb3Jhcnkgc3RhdGUncyBsaXN0CiAgICAgICAgICAgICAgICBsYXN0X3N0YXRlLmFwcGVuZChsaXN0KGxhc3RfY2VsbHMpKQogICAgICAgICAgICAKICAgICAgICAgICAgIyB3ZSB1cGRhdGUgdGhlIGdyaWQncyBzdGF0ZSBhbmQgY2hhbmdlIHRoZSBoaXN0b3J5CiAgICAgICAgICAgIHNlbGYuZ3JpZC5zdGF0ZSA9IGxhc3Rfc3RhdGUKICAgICAgICAgICAgc2VsZi5oaXN0b3J5LnBvcCgpCiAgICAgICAgICAgIAogICAgICAgICAgICBzZWxmLm1vdmVzIC09IDEKCiAgICAgICAgc2VsZi5kcmF3KCkKICAgIAoKICAgIGRlZiByZXNldChzZWxmKToKICAgICAgICAiIiJSZXNldCB0aGUgZ2FtZS4KICAgICAgICBJdCByZXNldHMgdGhlIGdyaWQsIHRoZSBoaXN0b3J5LCB0aGUgY3VycmVudCBwbGF5ZXIsCiAgICAgICAgdGhlIG51bWJlcnMgb2YgbW92ZXMgcGxheWVkIGFuZCBmaW5hbGx5IGRyYXcgdGhlIGJvYXJkIGFuZCB0aGUgZ2FtZS4iIiIKCiAgICAgICAgc2VsZi5wbGF5aW5nID0gVHJ1ZQoKICAgICAgICAjIGdyaWQgaW5pdGlhbGl6YXRpb24KICAgICAgICBzZWxmLmdyaWQuc3RhdGUgPSBbXQogICAgICAgIGZvciBpIGluIHJhbmdlKDYpOgogICAgICAgICAgICBzZWxmLmdyaWQuc3RhdGUuYXBwZW5kKFswXSAqIDcpCiAgICAgICAgCiAgICAgICAgIyBoaXN0b3J5IGluaXRpYWxpemF0aW9uCiAgICAgICAgc2VsZi5oaXN0b3J5ID0gW10KICAgICAgICBoaXN0b3J5X3RlbXAgPSBbXQoKICAgICAgICBmb3IgaSBpbiByYW5nZSg2KToKICAgICAgICAgICAgaGlzdG9yeV90ZW1wLmFwcGVuZChbMF0gKiA3KQogICAgICAgIAogICAgICAgIHNlbGYuaGlzdG9yeS5hcHBlbmQoaGlzdG9yeV90ZW1wKQoKICAgICAgICAjIHJlc2V0IHRoZSBjdXJyZW50IHBsYXllciBhbmQgdGhlIG51bWJlcnMgb2YgbW92ZXMKICAgICAgICBzZWxmLmN1cnJlbnRfcGxheWVyID0gKHNlbGYucGxheWVyMS5zY29yZSArIHNlbGYucGxheWVyMi5zY29yZSkgJSAyICsgMQogICAgICAgIHNlbGYuc3RhdHVzLnRleHQgPSBmJ3tzZWxmLnBsYXllcnNbc2VsZi5jdXJyZW50X3BsYXllciAtIDFdLm5hbWV9ICh7c2VsZi5wbGF5ZXJzW3NlbGYuY3VycmVudF9wbGF5ZXIgLSAxXS5jb2x9KSB0byBtb3ZlJwogICAgICAgIHNlbGYubW92ZXMgPSAwCiAgICAgICAgCiAgICAgICAgIyBib2FyZCBhbmQgZ2FtZSBkcmF3aW5nCiAgICAgICAgc2VsZi5ib2FyZCgpCiAgICAgICAgc2VsZi5zY29yZXMuZHJhdygpCiAgICAgICAgc2VsZi5kcmF3KCkKICAgIAoKICAgIGRlZiByZXNldF9zY29yZXMoc2VsZik6CiAgICAgICAgIiIiUmVzZXQgdGhlIHNjb3JlIG9mIGJvdGggcGxheWVycyBhbmQgZGlzcGxheSBpdC4iIiIKCiAgICAgICAgIyByZXNldCB0aGUgcGxheWVycydzIHNjb3JlCiAgICAgICAgZm9yIHBsYXllciBpbiBzZWxmLnBsYXllcnM6CiAgICAgICAgICAgIHBsYXllci5zY29yZSA9IDAKICAgICAgICAKICAgICAgICAjIHJlc2V0IHRoZSBnYW1lCiAgICAgICAgc2VsZi5yZXNldCgpCgogICAgICAgICMgdXBkYXRlIHRoZSB0ZXh0J3Mgc2NvcmUsIGVyYXNlIHRoZSBvbGQgc2NvcmVzIGFuZCBkaXNwbGF5IHRoZSBuZXcgb25lCiAgICAgICAgc2VsZi5zY29yZXMudGV4dCA9IGYnU2NvcmVzIDpcblxue3NlbGYucGxheWVyMS5uYW1lfSA6IHtzZWxmLnBsYXllcjEuc2NvcmV9XG5cbntzZWxmLnBsYXllcjIubmFtZX0gOiB7c2VsZi5wbGF5ZXIyLnNjb3JlfScKICAgICAgICBzZWxmLnNjb3Jlc19lcmFzZXIuZHJhdygpCiAgICAgICAgc2VsZi5zY29yZXMuZHJhdygpCgoKICAgIGRlZiBzYXZlKHNlbGYpOgogICAgICAgICIiIlNhdmUgdGhlIHN0YXRlIG9mIHRoZSBnYW1lIGluIHRoZSBoaXN0b3J5LiIiIgoKICAgICAgICBjdXJyZW50X3N0YXRlID0gW10KCiAgICAgICAgIyB3ZSBnbyB0aHJvdWdoIGxpbmVzIGFuZCBjb2x1bW5zCiAgICAgICAgZm9yIGxpbmUgaW4gcmFuZ2UoNik6CiAgICAgICAgICAgIGN1cnJlbnRfY2VsbHMgPSBbXQoKICAgICAgICAgICAgZm9yIGNlbGwgaW4gcmFuZ2UoNyk6CiAgICAgICAgICAgICAgICAjIHRoZSBjZWxscyBvZiBvbmUgY29sdW1uIGFyZSBhZGRlZCB0byB0aGUgdGVtcG9yYXJ5IGNlbGxzJ3MgbGlzdAogICAgICAgICAgICAgICAgY3VycmVudF9jZWxscy5hcHBlbmQoaW50KHNlbGYuZ3JpZC5zdGF0ZVtsaW5lXVtjZWxsXSkpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIHRoZSBsaW5lIGlzIGFkZGVkIHRvIHRoZSB0ZW1wb3Jhcnkgc3RhdGUncyBsaXN0CiAgICAgICAgICAgIGN1cnJlbnRfc3RhdGUuYXBwZW5kKGxpc3QoY3VycmVudF9jZWxscykpCiAgICAgICAgCiAgICAgICAgIyB3ZSBhZGQgdGhlIGN1cnJlbnQgc3RhdGUgdG8gdGhlIGhpc3RvcnkKICAgICAgICBzZWxmLmhpc3RvcnkuYXBwZW5kKGxpc3QoY3VycmVudF9zdGF0ZSkpCgoKICAgIGRlZiBwbGF5KHNlbGYsIGNvbHVtbik6CiAgICAgICAgIiIiQ2hhbmdlIHRoZSBzdGF0ZSBvZiBvbmUgZ3JpZCdzIGNvbHVtbi4iIiIKICAgICAgICAKICAgICAgICAjIG5vIG9uZSBtdXN0IGhhdmUgd29uCiAgICAgICAgaWYgc2VsZi5wbGF5aW5nOgoKICAgICAgICAgICAgIyBmcm9tIHRoZSBib3R0b20gdG8gdGhlIHRvcCBvZiB0aGUgY29sdW1uCiAgICAgICAgICAgIGZvciBqIGluIHJhbmdlKDUsIC0xLCAtMSk6CgogICAgICAgICAgICAgICAgIyBpZiB0aGUgY2VsbCBpcyBmcmVlCiAgICAgICAgICAgICAgICBpZiBzZWxmLmdyaWQuc3RhdGVbal1bY29sdW1uXSA9PSAwOgogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgd2UgY2hhbmdlIHRoZSBjZWxsJ3MgdmFsdWUgKGRlcGVuZGluZyBvZiB0aGUgY3VycmVudCBwbGF5ZXIpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ncmlkLnN0YXRlW2pdW2NvbHVtbl0gPSBzZWxmLmN1cnJlbnRfcGxheWVyCgogICAgICAgICAgICAgICAgICAgIHNlbGYubW92ZXMgKz0gMQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2F2ZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5jaGVja193aW4oKQoKICAgICAgICAgICAgICAgICAgICAjIGFmdGVyIHRoZSBjaGVja193aW4gZnVuY3Rpb24sIHNvbWVvbmUgaGFzIG1heWJlIHdvbgogICAgICAgICAgICAgICAgICAgICMgaWYgc29tZW9uZSBoYXMgd29uIChub3QgYSBkcmF3KQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLnBsYXlpbmcgYW5kICBub3Qgc2VsZi5ub193aW5uZXI6CgogICAgICAgICAgICAgICAgICAgICAgICAjIGFkZCBhIHBvaW50IHRvIHRoZSBzY29yZSBvZiB0aGUgY3VycmVudCBwbGF5ZXIKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbGF5ZXJzW3NlbGYuY3VycmVudF9wbGF5ZXIgLSAxXS5zY29yZSArPSAxCgogICAgICAgICAgICAgICAgICAgICAgICAjIHVwZGF0ZSB0aGUgdGV4dCdzIHNjb3JlcwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNjb3Jlcy50ZXh0ID0gZidTY29yZXMgOlxuXG57c2VsZi5wbGF5ZXIxLm5hbWV9IDoge3NlbGYucGxheWVyMS5zY29yZX1cblxue3NlbGYucGxheWVyMi5uYW1lfSA6IHtzZWxmLnBsYXllcjIuc2NvcmV9JwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgIyBlcmFzZSB0aGUgb2xkIHNjb3JlcyBhbmQgZGlzcGxheSB0aGUgbmV3IG9uZQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNjb3Jlc19lcmFzZXIuZHJhdygpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2NvcmVzLmRyYXcoKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgIyB1cGRhdGUgdGhlIHRleHQgb2YgdGhlIHdpbiBtZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYud2luX21lc3NhZ2UudGV4dCA9IGYnKiAgKiAgKiAgKiAgKlxue3NlbGYucGxheWVyc1tzZWxmLmN1cnJlbnRfcGxheWVyIC0gMV0ubmFtZX1cbldJTlMgISEhXG4qICAqICAqICAqICAqJwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgIyBlcmFzZSB0aGUgb2xkIHdpbiBtZXNzYWdlIGFuZCBkcmF3IHRoZSBuZXcgb25lCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYud2luX21lc3NhZ2VfZXJhc2VyLmRyYXcoKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLndpbl9tZXNzYWdlLmRyYXcoKQoKCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3dpdGNoX3BsYXllcnMoKQoKCiAgICAgICAgICAgICAgICAgICAgICAgICMgdmljdG9yeSBtdXNpYwoKICAgICAgICAgICAgICAgICAgICAgICAgIyBmYXN0IGZhZGVvdXQgb2YgdGhlIGN1cnJlbnQgZ2FtZSdzIG11c2ljCiAgICAgICAgICAgICAgICAgICAgICAgIG11c2ljLmZhZGVvdXQoMTAwKQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBsb2FkaW5nIG9mIHRoZSB2aWN0b3J5IG11c2ljCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVEaXIgPSBvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5yZWFscGF0aCgnX19maWxlX18nKSkKICAgICAgICAgICAgICAgICAgICAgICAgIyBwcmludChmaWxlRGlyKQogICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IG9zLnBhdGguam9pbihmaWxlRGlyLCAnc3JjL3Byb2pldC9wcm9qZXQ3L3dpbi53YXYnKSAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgbXVzaWMubG9hZChmaWxlbmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICMgc3RhcnQgdGhlIHZpY3RvcnkgbXVzaWMKICAgICAgICAgICAgICAgICAgICAgICAgbXVzaWMucGxheSgpCiAgICAgICAgICAgICAgICAgICAgICAgIHNsZWVwKDMpCgogICAgICAgICAgICAgICAgICAgICAgICAjIGxvYWRpbmcgb2YgdGhlIGdhbWUncyBtdXNpYwogICAgICAgICAgICAgICAgICAgICAgICBmaWxlRGlyID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGgucmVhbHBhdGgoJ19fZmlsZV9fJykpCiAgICAgICAgICAgICAgICAgICAgICAgICMgcHJpbnQoZmlsZURpcikKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBvcy5wYXRoLmpvaW4oZmlsZURpciwgJ3NyYy9wcm9qZXQvcHJvamV0Ny9jb25uZWN0XzRfYXVkaW8ubXAzJykgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIG11c2ljLmxvYWQoZmlsZW5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAjIHN0YXJ0IHRoZSBnYW1lJ3MgbXVzaWMgKC0xIDw9PiBpbmZpbml0ZSBsb29wKQogICAgICAgICAgICAgICAgICAgICAgICBtdXNpYy5wbGF5KC0xKQoKCiAgICAgICAgICAgICAgICAgICAgIyBpZiB0aGUgcGxheWVycyBhcmUgcGxheWluZwogICAgICAgICAgICAgICAgICAgIGVsaWYgbm90IHNlbGYubm9fd2lubmVyOgoKICAgICAgICAgICAgICAgICAgICAgICAgIyB3ZSBzd2l0Y2ggdGhlIHBsYXllcnMKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zd2l0Y2hfcGxheWVycygpCgogICAgICAgICAgICAgICAgICAgICAgICAjIHdlIGVyYXNlIHRoZSBvbGQgc3RhdHVzIGFuZCBkcmF3IHRoZSBuZXcgb25lCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3RhdHVzX2VyYXNlci5kcmF3KCkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zdGF0dXMuZHJhdygpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgIAogICAgCiAgICBkZWYgcXVpdChzZWxmKToKICAgICAgICAiIiJRdWl0IHRoZSBnYW1lLCBkcmF3IHRoZSBmaW5hbCBzY3JlZW4uIiIiCgogICAgICAgIHNlbGYucnVuID0gRmFsc2UKICAgICAgICAKICAgICAgICAjIGRyYXcgdGhlIGJhY2tncm91bmQgKGl0IGVyYXNlcyBhbGwgdGhlIGVsZW1lbnQgZGlzcGxheWVkKQogICAgICAgIGRvdCgxNTAwLCAnZGVlcHNreWJsdWUnKQoKICAgICAgICAjIGVuZCBvZiB0aGUgbXVzaWMsIHdpdGggYSBmYWRlb3V0IGVmZmVjdAogICAgICAgIG11c2ljLmZhZGVvdXQoMjAwMCkKCiAgICAgICAgIyB3cml0ZSBhIGxhc3QgbWVzc2FnZQogICAgICAgIGdvdG8oMCwgNTApCiAgICAgICAgd3JpdGUoJ1RoYW5rcyBmb3IgcGxheWluZyAhJywgZm9udD0oJ1RpbWVzJywgNDApLCBhbGlnbj0nY2VudGVyJykKICAgICAgICAKICAgICAgICAjIGRyYXcgdGhlIG5hbWUgb2YgdGhlIGF1dGhvcgogICAgICAgIHNlbGYuYXV0aG9yLmRyYXcoKQoKICAgICAgICAjIGRpc3BsYXkgdGhlIGZpbmFsIOKAnENMT1NF4oCcIGJ1dHRvbgogICAgICAgIHNlbGYuYnRfY2xvc2UuZGlzcGxheWVkID0gVHJ1ZQogICAgICAgIHNlbGYuYnRfY2xvc2UuZHJhdygpCiAgICAKCiAgICBkZWYgY2xpY2soc2VsZiwgeCwgeSk6CiAgICAgICAgIiIiUmVhY3RzIHRvIG1vdXNlIGNsaWNrcy4iIiIKCiAgICAgICAgIyBpZiB0aGUgcGxheWVycyBhcmUgcGxheWluZwogICAgICAgIGlmIHNlbGYucnVuOgoKICAgICAgICAgICAgIyB0aGUgcGxheWVyIGNsaWNrcyBvbiB0aGUgZ3JpZAogICAgICAgICAgICBpZiBzZWxmLmdyaWQuaW5zaWRlKHgsIHkpIGFuZCBzZWxmLnBsYXlpbmc6CiAgICAgICAgICAgICAgICBpID0gc2VsZi5ncmlkLmdldF9jb2x1bW4oeCwgeSkKICAgICAgICAgICAgICAgIHNlbGYucGxheShpKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBidXR0b25zCiAgICAgICAgICAgIHAgPSB4LCB5CgogICAgICAgICAgICAjIHRoZSBwbGF5ZXIgY2xpY2tzIG9uIHRoZSDigJx1bmRv4oCcIGJ1dHRvbgogICAgICAgICAgICBpZiBzZWxmLmJ0X3VuZG8uaW5zaWRlKHApIGFuZCBsZW4oc2VsZi5oaXN0b3J5KSA+IDE6CiAgICAgICAgICAgICAgICBzZWxmLnVuZG8oKQogICAgICAgICAgICAKICAgICAgICAgICAgIyB0aGUgcGxheWVyIGNsaWNrcyBvbiB0aGUg4oCcbmV34oCcIGJ1dHRvbgogICAgICAgICAgICBpZiBzZWxmLmJ0X25ldy5pbnNpZGUocCk6CiAgICAgICAgICAgICAgICBzZWxmLnJlc2V0KCkKICAgICAgICAgICAgICAgIHNlbGYuZHJhdygpCgogICAgICAgICAgICAjIHRoZSBwbGF5ZXIgY2xpY2tzIG9uIHRoZSDigJxyZXNldCBhbGzigJwgYnV0dG9uCiAgICAgICAgICAgIGlmIHNlbGYuYnRfcmVzZXRfc2NvcmVzLmluc2lkZShwKToKICAgICAgICAgICAgICAgIHNlbGYucmVzZXRfc2NvcmVzKCkKICAgICAgICAgICAgCgogICAgICAgICAgICAjIHRoZSBwbGF5ZXIgY2xpY2tzIG9uIHRoZSDigJxxdWl04oCcIGJ1dHRvbgogICAgICAgICAgICBpZiBzZWxmLmJ0X3F1aXQuaW5zaWRlKHApOgogICAgICAgICAgICAgICAgc2VsZi5xdWl0KCkKICAgICAgICAKCiAgICAgICAgIyBwbGF5ZXJzIG5vIGxvbmdlciBwbGF5ID0+IHdlIGFyZSBhdCB0aGUgZmluYWwgc2NyZWVuCiAgICAgICAgZWxzZToKCiAgICAgICAgICAgICMgdGhlIHBsYXllciBjbGlja3Mgb24gdGhlIOKAnENMT1NF4oCcIGJ1dHRvbgogICAgICAgICAgICBpZiBzZWxmLmJ0X2Nsb3NlLmluc2lkZSgoeCwgeSkpOgogICAgICAgICAgICAgICAgcXVpdCgpCiAgICAgICAgCgogICAgZGVmIGRyYXcoc2VsZik6CiAgICAgICAgIiIiRHJhd3MgYWxsIHRoZSBnYW1lIG9iamVjdHMuIiIiCgogICAgICAgICMgZHJhdyB0aGUgZ3JpZCwgdGhlIHRpdGxlLCB0aGUgYXV0aG9yJ3MgbmFtZSBhbmQgdGhlIGNvbHVtbidzIG5hbWUKICAgICAgICBzZWxmLmdyaWQuZHJhdygpCiAgICAgICAgc2VsZi50aXRsZS5kcmF3KCkKICAgICAgICBzZWxmLmF1dGhvci5kcmF3KCkKCiAgICAgICAgIyB3ZSBlcmFzZSB0aGUgY3VycmVudCBzdGF0dXMKICAgICAgICBzZWxmLnN0YXR1c19lcmFzZXIuZHJhdygpCgoKICAgICAgICAjIGlmIHRoZSBwbGF5ZXJzIGFyZSBwbGF5aW5nCiAgICAgICAgaWYgc2VsZi5wbGF5aW5nOgoKICAgICAgICAgICAgIyB3cml0aW5nIG9mIHRoZSBnYW1lJ3Mgc3RhdHVzCiAgICAgICAgICAgIHNlbGYuc3RhdHVzLmRyYXcoKQogICAgICAgIAoKICAgICAgICAjIHBsYXllcnMgbm8gbG9uZ2VyIHBsYXkgPT4gd2UgYXJlIGF0IHRoZSBmaW5hbCBzY3JlZW4KICAgICAgICBlbHNlOgoKICAgICAgICAgICAgIyB3cml0aW5nIG9mIHRoZSBwbGF5ZXIncyBzY29yZXMKICAgICAgICAgICAgc2VsZi5zY29yZXMuZHJhdygpCgogICAgICAgICMgcnVucyB0aHJvdWdoIGFsbCB0aGUgYnV0dG9ucwogICAgICAgIGZvciBidXR0b24gaW4gW3NlbGYuYnRfdW5kbywgc2VsZi5idF9uZXcsIHNlbGYuYnRfcmVzZXRfc2NvcmVzLCBzZWxmLmJ0X3F1aXRdOgogICAgICAgICAgICAKICAgICAgICAgICAgIyBpZiB0aGUgYnV0dG9uIGhhdmUgdG8gYmUgZGlzcGxheWVkCiAgICAgICAgICAgIGlmIGJ1dHRvbi5kaXNwbGF5ZWQ6CgogICAgICAgICAgICAgICAgIyBkcmF3aW5nIG9mIHRoZSBidXR0b24KICAgICAgICAgICAgICAgIGJ1dHRvbi5kcmF3KCkKCgpnYW1lID0gR2FtZSgpCgpkb25lKCkK" data-file="Y29kZS5weQ==" frameborder="0" scrolling="no" src="../codeplay/frame.html"></iframe></div></section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../projet8/projet.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">8. </span>Othello</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../projet6/projet.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">6. </span>Démineur</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; OC info 2021 Bugnon |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="../_sources/projet7/projet.md.txt"
               rel="nofollow">
              Montrer le code source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contenu
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">7. Puissance 4</a><ul>
<li><a class="reference internal" href="#but-du-jeu">But du jeu</a></li>
<li><a class="reference internal" href="#description-du-jeu">Description du jeu</a></li>
<li><a class="reference internal" href="#comment-jouer">Comment jouer</a></li>
<li><a class="reference internal" href="#options-supplementaires">Options supplémentaires</a></li>
<li><a class="reference internal" href="#representation-de-letat">Réprésentation de l’état</a></li>
<li><a class="reference internal" href="#codeplay">Codeplay</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/main.js"></script>
    <script src="../_static/questions.js"></script>
    <script src="../_static/blanks.js"></script>
    <script src="../_static/timeline.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="../_static/scripts/reactions.js"></script>
    <script src="../_static/scripts/progress.js"></script>
    <script src="../_static/scripts/dark.js"></script>
    <script src="../_static/scripts/frames.js"></script>
    </body>
</html>